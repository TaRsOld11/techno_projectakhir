<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Transaksi | Aplikasi Keuangan</title>
  <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
  <link rel="stylesheet" href="assets/css/lineicons.css" />
  <link rel="stylesheet" href="assets/css/materialdesignicons.min.css" />
  <link rel="stylesheet" href="assets/css/main.css" />
  <style>
    .btn-tab {
      background: transparent;
      border: none;
      color: #6c757d;
      padding: 12px 24px;
      border-radius: 6px;
      transition: all 0.3s ease;
      font-weight: 500;
      font-size: 15px;
    }

    .btn-tab:hover {
      background: rgba(255, 255, 255, 0.5);
      color: #495057;
    }

    .btn-tab.active {
      background: white;
      color: #4A6CF7;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .btn-tab i {
      font-size: 18px;
      vertical-align: middle;
    }
  </style>
</head>

<body>
  <div id="preloader"><div class="spinner"></div></div>

  <aside class="sidebar-nav-wrapper" id="sidebar-area"></aside>
  
  <div class="overlay"></div>
  <main class="main-wrapper">
    <!-- ========== header start ========== -->
    <header class="header" id="header-area"></header>
    <!-- ========== header end ========== -->
    <section class="section">
      <div class="container-fluid">
        <div class="title-wrapper pt-30">
          <div class="row align-items-center">
            <div class="col-md-6">
              <div class="title">
                <h2>Daftar Transaksi</h2>
              </div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-lg-12">
            <div class="card-style mb-30">
              <div class="title d-flex flex-wrap align-items-center justify-content-between">
                <div class="left">
                  <h6 class="text-medium mb-30">Semua Riwayat</h6>
                </div>
                <div class="right">
                  <button type="button" class="main-btn primary-btn btn-hover btn-sm" data-bs-toggle="modal"
                    data-bs-target="#modalTambahTransaksi">
                    <i class="lni lni-plus mr-5"></i> Tambah Transaksi
                  </button>
                </div>
              </div>

              <div class="table-responsive">
                <table class="table top-selling-table">
                  <thead>
                    <tr>
                      <th>
                        <h6 class="text-sm text-medium">Tanggal</h6>
                      </th>
                      <th class="min-width">
                        <h6 class="text-sm text-medium">Kategori</h6>
                      </th>
                      <th class="min-width">
                        <h6 class="text-sm text-medium">Deskripsi</h6>
                      </th>
                      <th class="min-width">
                        <h6 class="text-sm text-medium">Nominal</h6>
                      </th>
                      <th class="min-width">
                        <h6 class="text-sm text-medium">Tipe</h6>
                      </th>
                      <th class="text-end">
                        <h6 class="text-sm text-medium">Aksi</h6>
                      </th>
                    </tr>
                  </thead>
                  <tbody id="transactionTableBody">

                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Modal Tambah Transaksi -->
    <div class="modal fade" id="modalTambahTransaksi" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content card-style">
          <div class="modal-header border-bottom pb-20">
            <h5 class="text-bold mb-0">Tambah Transaksi Baru</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body py-4">

            <div class="mb-4">
              <div class="d-flex gap-2 p-1 bg-light rounded">
                <button type="button" class="btn btn-tab active flex-fill" data-type="expense"
                  onclick="switchTab(this, 'add')">
                  <i class="lni lni-arrow-down-circle me-1"></i> Pengeluaran
                </button>
                <button type="button" class="btn btn-tab flex-fill" data-type="income" onclick="switchTab(this, 'add')">
                  <i class="lni lni-arrow-up-circle me-1"></i> Pemasukan
                </button>
              </div>
              <input type="hidden" id="tipeTransaksiInput" value="expense">
            </div>

            <div class="input-style-1 mb-3">
              <label class="form-label">Tanggal</label>
              <input type="date" id="inputDate" class="form-control" required>
            </div>

            <div class="mb-3">
              <label class="form-label">Kategori</label>
              <div class="d-flex gap-2">
                <div class="select-style-1 mb-0 flex-fill">
                  <div class="select-position">
                    <select id="kategoriSelect" class="form-select" required>
                      <option value="" disabled selected>Pilih Kategori</option>
                      </select>
                  </div>
                </div>
                <button type="button" class="btn btn-primary px-3" 
                        data-bs-toggle="modal" 
                        data-bs-target="#modalTambahKategori"
                        title="Buat Kategori Baru">
                  <i class="lni lni-plus"></i>
                </button>
              </div>
            </div>

            <div class="input-style-1 mb-3" id="customCategoryInput" style="display: none;">
              <label class="form-label">Nama Kategori Baru</label>
              <input type="text" class="form-control" placeholder="Contoh: Servis Motor">
            </div>

            <div class="input-style-1 mb-3">
              <label class="form-label">Nominal (Rp)</label>
              <input type="text" id="inputNominal" class="form-control" placeholder="0" required>
              <input type="hidden" id="inputNominalValue">
            </div>

            <div class="input-style-1 mb-0">
              <label class="form-label">Deskripsi / Catatan</label>
              <textarea class="form-control" placeholder="Contoh: Makan siang di restoran..." rows="3"></textarea>
            </div>

          </div>
          <div class="modal-footer border-top pt-20">
            <button type="button" class="main-btn danger-btn-outline btn-hover" data-bs-dismiss="modal">
              <i class="lni lni-close me-1"></i> Batal
            </button>
            <button type="button" class="main-btn primary-btn btn-hover" onclick="saveTransaction()">
              <i class="lni lni-save me-1"></i> Simpan
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Edit Transaksi -->
    <div class="modal fade" id="modalEditTransaksi" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content card-style">
          <div class="modal-header border-bottom pb-20">
            <h5 class="text-bold mb-0">Edit Transaksi</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body py-4">

            <div class="mb-4">
              <div class="d-flex gap-2 p-1 bg-light rounded">
                <button type="button" class="btn btn-tab flex-fill" data-type="expense"
                  onclick="switchTab(this, 'edit')">
                  <i class="lni lni-arrow-down-circle me-1"></i> Pengeluaran
                </button>
                <button type="button" class="btn btn-tab flex-fill" data-type="income"
                  onclick="switchTab(this, 'edit')">
                  <i class="lni lni-arrow-up-circle me-1"></i> Pemasukan
                </button>
              </div>
              <input type="hidden" id="tipeTransaksiInputEdit" value="">
            </div>

            <div class="input-style-1 mb-3">
              <label class="form-label">Tanggal</label>
              <input type="date" id="inputDateEdit" class="form-control" required>
            </div>

            <div class="select-style-1 mb-3">
              <label class="form-label">Kategori</label>
              <div class="select-position">
                <select id="kategoriSelectEdit" class="form-select" onchange="checkCustomCategoryEdit(this)" required>
                  <option value="" disabled>Pilih Kategori</option>
                  <option value="makan">üçΩÔ∏è Makan & Minum</option>
                  <option value="transport">üöó Transportasi</option>
                  <option value="belanja">üõí Belanja Bulanan</option>
                  <option value="tagihan">‚ö° Tagihan & Listrik</option>
                  <option value="gaji">üí∞ Gaji</option>
                  <option value="custom">‚ûï Buat Kategori Baru...</option>
                </select>
              </div>
            </div>

            <div class="input-style-1 mb-3" id="customCategoryInputEdit" style="display: none;">
              <label class="form-label">Nama Kategori Baru</label>
              <input type="text" class="form-control" placeholder="Contoh: Servis Motor">
            </div>

            <div class="input-style-1 mb-3">
              <label class="form-label">Nominal (Rp)</label>
              <input type="text" id="inputNominalEdit" class="form-control" placeholder="0" required>
              <input type="hidden" id="inputNominalEditValue">

            </div>

            <div class="input-style-1 mb-0">
              <label class="form-label">Deskripsi / Catatan</label>
              <textarea id="inputDeskripsiEdit" class="form-control" placeholder="Contoh: Makan siang di restoran..."
                rows="3"></textarea>
            </div>

          </div>
          <div class="modal-footer border-top pt-20">
            <button type="button" class="main-btn danger-btn-outline btn-hover" data-bs-dismiss="modal">
              <i class="lni lni-close me-1"></i> Batal
            </button>
            <button type="button" class="main-btn primary-btn btn-hover" onclick="updateTransaction()">
              <i class="lni lni-checkmark-circle me-1"></i> Update
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="modal fade" id="modalTambahKategori" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-sm"> <div class="modal-content card-style">
          <div class="modal-header border-bottom pb-2">
            <h6 class="text-bold mb-0">Buat Kategori Baru</h6>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body py-4">
            <div class="input-style-1 mb-0">
              <label>Nama Kategori</label>
              <input type="text" id="inputNewCategoryName" placeholder="Contoh: Pulsa / Investasi" autofocus>
            </div>
            <p class="text-sm text-gray mt-2">
              Akan ditambahkan ke: <strong id="labelTipeKategori" class="text-primary">Pengeluaran</strong>
            </p>
          </div>
          <div class="modal-footer pt-2">
            <button type="button" class="btn btn-sm danger-btn-outline" data-bs-dismiss="modal">Batal</button>
            <button type="button" class="btn btn-sm primary-btn" onclick="saveNewCategory()">Simpan</button>
          </div>
        </div>
      </div>
    </div>

    <footer class="footer" id="footer-area"></footer>
  </main>
<script src="assets/js/bootstrap.bundle.min.js"></script>
<script src="assets/js/main.js"></script>
<script src="api.js"></script> 
<script src="layout.js"></script> <script>
    // --- VARIABEL GLOBAL ---
    let globalIncomeCategories = [];
    let globalExpenseCategories = [];
    let currentEditId = null;

    // --- 1. INISIALISASI (JALAN PERTAMA KALI) ---
    document.addEventListener('DOMContentLoaded', async function () {
        checkAuth(); // Cek apakah user sudah login
        
        // Setup Formatter Rupiah
        bindRupiahInput("inputNominal", "inputNominalValue");
        bindRupiahInput("inputNominalEdit", "inputNominalEditValue");
        
        // Set Tanggal Default hari ini
        document.getElementById('inputDate').valueAsDate = new Date();

        // LOAD DATA BERURUTAN (PENTING!)
        // Kita tunggu kategori selesai dulu, baru load transaksi
        await loadAllCategories(); 
        await loadTransactions();
    });

    // --- 2. LOAD KATEGORI (Kode Kamu + Validasi) ---
    async function loadAllCategories() {
        try {
            const headers = getAuthHeaders();
            const [resInc, resExp] = await Promise.all([
                fetch(`${API_BASE_URL}/income-categories`, { headers }),
                fetch(`${API_BASE_URL}/expense-categories`, { headers })
            ]);

            const dataInc = await resInc.json();
            const dataExp = await resExp.json();

            // Simpan ke Global (Handle struktur response API yang beda-beda)
            globalIncomeCategories = dataInc.data || dataInc || [];
            globalExpenseCategories = dataExp.data || dataExp || [];

            // Render dropdown awal (sesuai tab aktif)
            const currentTab = document.querySelector('.btn-tab.active');
            const type = currentTab ? currentTab.getAttribute('data-type') : 'expense';
            renderCategoryOptions(type, 'kategoriSelect');

        } catch (error) {
            console.error("Gagal load kategori:", error);
        }
    }

    // --- 3. LOAD TRANSAKSI (TAMPILKAN DATA) ---
    async function loadTransactions() {
        const tbody = document.getElementById('transactionTableBody');
        tbody.innerHTML = '<tr><td colspan="6" class="text-center">Memuat data...</td></tr>';

        try {
            const headers = getAuthHeaders();
            const [resInc, resExp] = await Promise.all([
                fetch(`${API_BASE_URL}/income-batches`, { headers }),
                fetch(`${API_BASE_URL}/expense-batches`, { headers })
            ]);

            if (!resInc.ok) throw new Error('Income fetch failed');
            if (!resExp.ok) throw new Error('Expense fetch failed');


            // Normalisasi Data
            const rawIncomes = dInc.data || dInc || [];
            const rawExpenses = dExp.data || dExp || [];

            // Mapping Data biar seragam
            const incomes = rawIncomes.map(item => ({
                id: item.id,
                type: 'income',
                date: item.incomeDate || item.createdAt,
                categoryId: item.categoryId,
                description: item.description,
                amount: item.totalAmount
            }));

            const expenses = rawExpenses.map(item => ({
                id: item.id,
                type: 'expense',
                date: item.expenseDate || item.createdAt,
                categoryId: item.categoryId,
                description: item.description,
                amount: item.totalAmount
            }));

            // Gabung & Urutkan (Terbaru diatas)
            const allTrans = [...incomes, ...expenses];
            allTrans.sort((a, b) => new Date(b.date) - new Date(a.date));

            // Render ke Tabel
            tbody.innerHTML = '';

            if (allTrans.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="text-center">Belum ada transaksi.</td></tr>';
                return;
            }

            allTrans.forEach(item => {
                const isIncome = item.type === 'income';
                const amountNumber = Number(item.amount) || 0;
                const nominal = formatRupiah(amountNumber.toString(), 'Rp');

                const dateDisplay = new Date(item.date).toLocaleDateString('id-ID');
                
                // CARI NAMA KATEGORI BERDASARKAN ID (PENTING!)
                // Kita cari di variabel global yang sudah diisi di awal
                const catName = getCategoryName(item.categoryId, item.type);
                
                // Escape tanda kutip untuk safety tombol edit
                const safeDesc = (item.description || '').replace(/'/g, "&apos;").replace(/"/g, "&quot;");

                tbody.innerHTML += `
                    <tr>
                        <td><p class="text-sm">${dateDisplay}</p></td>
                        <td><p class="text-sm fw-bold">${catName}</p></td>
                        <td><p class="text-sm text-gray">${item.description || '-'}</p></td>
                        <td><p class="text-sm ${isIncome ? 'text-success' : 'text-danger'} fw-bold">${nominal}</p></td>
                        <td><span class="status-btn ${isIncome ? 'success-btn' : 'close-btn'}">${isIncome ? 'Masuk' : 'Keluar'}</span></td>
                        <td>
                            <div class="action justify-content-end">
                                <button class="edit" data-bs-toggle="modal" data-bs-target="#modalEditTransaksi"
                                    onclick="editTransaction('${item.id}', '${item.date}', '${catName}', '${safeDesc}', '${item.amount}', '${item.type}')">
                                    <i class="lni lni-pencil"></i>
                                </button>
                                <button class="text-danger ml-10" onclick="deleteTransaction('${item.id}', '${item.type}')">
                                    <i class="lni lni-trash-can"></i>
                                </button>
                            </div>
                        </td>
                    </tr>
                `;
            });

        } catch (error) {
            console.error("Error load transactions:", error);
            tbody.innerHTML = '<tr><td colspan="6" class="text-center text-danger">Belum ada transaksi.</td></tr>';
        }
    }

    // --- 4. SIMPAN TRANSAKSI BARU ---
    async function saveTransaction() {
        const btn = document.querySelector('#modalTambahTransaksi .primary-btn');
        const originalText = btn.innerHTML;
        
        const type = document.getElementById('tipeTransaksiInput').value || 'expense';
        const categoryId = document.getElementById('kategoriSelect').value;
        const total = document.getElementById('inputNominalValue').value;
        const description = document.querySelector('#modalTambahTransaksi textarea').value;
        const dateValue = document.getElementById('inputDate').value;

        if (!categoryId) { alert("Pilih Kategori!"); return; }
        if (!total) { alert("Isi Nominal!"); return; }
        if (!dateValue) { alert("Isi Tanggal!"); return; }

        btn.innerHTML = 'Menyimpan...';
        btn.disabled = true;

        try {
            const endpoint = type === 'income' ? '/income-batches' : '/expense-batches';
            const dateKey = type === 'income' ? 'incomeDate' : 'expenseDate';

            const payload = {
                categoryId: categoryId,
                totalAmount: total.toString(), // String
                description: description || "-"
            };
            payload[dateKey] = dateValue;

            console.log("Kirim:", payload);

            const response = await fetch(`${API_BASE_URL}${endpoint}`, {
                method: 'POST',
                headers: getAuthHeaders(),
                body: JSON.stringify(payload)
            });

            if (response.ok) {
                alert("‚úÖ Transaksi Berhasil!");
                bootstrap.Modal.getInstance(document.getElementById('modalTambahTransaksi')).hide();
                loadTransactions(); // Reload tabel
                
                // Reset Form
                document.getElementById('inputNominal').value = '';
                document.getElementById('inputNominalValue').value = '';
                document.querySelector('#modalTambahTransaksi textarea').value = '';
            } else {
                const res = await response.json();
                alert("‚ùå Gagal: " + (res.message || "Error Server"));
            }
        } catch (e) {
            console.error(e);
            alert("Error Koneksi.");
        } finally {
            btn.innerHTML = originalText;
            btn.disabled = false;
        }
    }

    // --- 5. EDIT TRANSAKSI ---
    function editTransaction(id, dateRaw, catName, desc, nominal, type) {
        currentEditId = id;
        
        // Isi Form Edit
        const dateOnly = new Date(dateRaw).toISOString().split('T')[0];
        document.getElementById('inputDateEdit').value = dateOnly;
        document.getElementById('inputNominalEdit').value = formatRupiah(nominal.toString(), 'Rp');
        document.getElementById('inputNominalEditValue').value = nominal;
        document.getElementById('inputDeskripsiEdit').value = desc;

        // Klik Tab yang sesuai
        const tab = document.querySelector(`#modalEditTransaksi .btn-tab[data-type="${type}"]`);
        if(tab) switchTab(tab, 'edit');

        // Pilih Kategori (Cari berdasarkan Nama atau ID)
        // Kita paksa render ulang dropdown edit sesuai tipe dulu
        renderCategoryOptions(type, 'kategoriSelectEdit');
        
        // Timeout sedikit biar render selesai, baru set value
        setTimeout(() => {
            const select = document.getElementById('kategoriSelectEdit');
            // Coba cari option yang teks-nya sama dengan catName
            for (let i = 0; i < select.options.length; i++) {
                if (select.options[i].text === catName) {
                    select.selectedIndex = i;
                    break;
                }
            }
        }, 100);
    }

    async function updateTransaction() {
        const type = document.getElementById('tipeTransaksiInputEdit').value;
        const categoryId = document.getElementById('kategoriSelectEdit').value;
        const total = document.getElementById('inputNominalEditValue').value;
        const description = document.getElementById('inputDeskripsiEdit').value;
        const dateValue = document.getElementById('inputDateEdit').value;

        try {
            const endpoint = type === 'income' ? `/income-batches/${currentEditId}` : `/expense-batches/${currentEditId}`;
            const dateKey = type === 'income' ? 'incomeDate' : 'expenseDate';

            const payload = {
                categoryId: categoryId,
                totalAmount: total.toString(),
                description: description || "-"
            };
            payload[dateKey] = dateValue;

            const response = await fetch(`${API_BASE_URL}${endpoint}`, {
                method: 'PATCH', // atau PUT
                headers: getAuthHeaders(),
                body: JSON.stringify(payload)
            });

            if (response.ok) {
                alert("‚úÖ Update Berhasil!");
                bootstrap.Modal.getInstance(document.getElementById('modalEditTransaksi')).hide();
                loadTransactions();
            } else {
                alert("Gagal Update.");
            }
        } catch (e) { console.error(e); alert("Error sistem."); }
    }

    // --- 6. HAPUS TRANSAKSI ---
    async function deleteTransaction(id, type) {
        if (!confirm('Hapus permanen?')) return;
        try {
            const endpoint = type === 'income' ? `/income-batches/${id}` : `/expense-batches/${id}`;
            const response = await fetch(`${API_BASE_URL}${endpoint}`, {
                method: 'DELETE',
                headers: getAuthHeaders()
            });

            if (response.ok) loadTransactions();
            else alert("Gagal menghapus.");
        } catch (e) { alert("Error koneksi."); }
    }

    // --- 7. UTILS & HELPER ---
    
    // Fungsi Switch Tab (Pemasukan/Pengeluaran)
    function switchTab(button, context) {
        const parent = button.parentElement;
        parent.querySelectorAll('.btn-tab').forEach(b => b.classList.remove('active'));
        button.classList.add('active');

        const type = button.getAttribute('data-type');
        
        if (context === 'add') {
            document.getElementById('tipeTransaksiInput').value = type;
            renderCategoryOptions(type, 'kategoriSelect');
        } else {
            document.getElementById('tipeTransaksiInputEdit').value = type;
            renderCategoryOptions(type, 'kategoriSelectEdit');
        }
    }

    // Render Dropdown Kategori
    function renderCategoryOptions(type, selectId) {
        const select = document.getElementById(selectId);
        select.innerHTML = '<option value="" disabled selected>Pilih Kategori</option>';
        
        const data = type === 'income' ? globalIncomeCategories : globalExpenseCategories;

        if(!data || data.length === 0) {
            select.innerHTML += '<option disabled>Tidak ada kategori.</option>';
        } else {
            data.forEach(cat => {
                select.innerHTML += `<option value="${cat.id}">${cat.name}</option>`;
            });
        }
    }

    // Helper: Cari Nama Kategori dari Array Global
    function getCategoryName(id, type) {
        const list = type === 'income' ? globalIncomeCategories : globalExpenseCategories;
        if (!list) return '-';
        const found = list.find(cat => cat.id === id);
        return found ? found.name : 'Tanpa Kategori';
    }

    // Helper: Format Rupiah (Support Desimal String "125000.00")
    function formatRupiah(angka, prefix) {
        if (!angka) return 'Rp 0';
        
        // 1. Bersihkan karakter aneh, tapi biarkan titik (.)
        // 2. Parse ke Float biar desimal .00 dianggap angka
        const number = parseFloat(angka);
        
        if (isNaN(number)) return 'Rp 0';

        // 3. Format ke Rupiah Indonesia (Otomatis handle ribuan & desimal)
        const result = new Intl.NumberFormat('id-ID', {
            style: 'currency',
            currency: 'IDR',
            minimumFractionDigits: 0,
            maximumFractionDigits: 0 // Kita bulatkan, hilangkan ,00
        }).format(number);

        return result; 
    }

    function bindRupiahInput(inputId, hiddenId) {
    const input = document.getElementById(inputId);
    const hidden = document.getElementById(hiddenId);
    
    if(input && hidden) {
        input.addEventListener('keyup', function () {
            // 1. Ambil angka murni (hapus karakter non-digit)
            const cleanValue = this.value.replace(/\D/g, ""); 
            
            // 2. Simpan ke hidden input (untuk dikirim ke API)
            hidden.value = cleanValue; 

            // 3. Format tampilan visual ke Rupiah
            if (cleanValue === "") {
                this.value = "";
            } else {
                this.value = formatRupiah(cleanValue, 'Rp');
            }
        });
    }
}

    // Logic Modal Tambah Kategori
    async function saveNewCategory() {
        const name = document.getElementById('inputNewCategoryName').value;
        const currentType = document.getElementById('tipeTransaksiInput').value || 'expense';

        if (!name) { alert("Isi nama kategori!"); return; }

        try {
            const endpoint = currentType === 'income' ? '/income-categories' : '/expense-categories';
            const response = await fetch(`${API_BASE_URL}${endpoint}`, {
                method: 'POST',
                headers: getAuthHeaders(),
                body: JSON.stringify({ name: name })
            });

            if (response.ok) {
                alert("Kategori Dibuat!");
                await loadAllCategories(); // Reload kategori biar ID-nya masuk
                
                // Render ulang dropdown
                renderCategoryOptions(currentType, 'kategoriSelect');
                
                // Tutup modal
                bootstrap.Modal.getInstance(document.getElementById('modalTambahKategori')).hide();
            } else {
                alert("Gagal membuat kategori.");
            }
        } catch (e) { alert("Error koneksi."); }
    }
</script>
</body>

</html>