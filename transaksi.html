<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Transaksi | Aplikasi Keuangan</title>
  <link rel="stylesheet" href="assets/css/bootstrap.min.css" />
  <link rel="stylesheet" href="assets/css/lineicons.css" />
  <link rel="stylesheet" href="assets/css/materialdesignicons.min.css" />
  <link rel="stylesheet" href="assets/css/main.css" />
  <style>
    .btn-tab {
      background: transparent;
      border: none;
      color: #6c757d;
      padding: 12px 24px;
      border-radius: 6px;
      transition: all 0.3s ease;
      font-weight: 500;
      font-size: 15px;
    }

    .btn-tab:hover {
      background: rgba(255, 255, 255, 0.5);
      color: #495057;
    }

    .btn-tab.active {
      background: white;
      color: #4A6CF7;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .btn-tab i {
      font-size: 18px;
      vertical-align: middle;
    }
  </style>
</head>

<body>
  <div id="preloader">
    <div class="spinner"></div>
  </div>
  <!-- ======== sidebar-nav start =========== -->
  <aside class="sidebar-nav-wrapper">
    <div class="navbar-logo">
      <a href="index.html">
        <img src="assets/images/logo/My Duit.png" alt="logo" />
      </a>
    </div>
    <nav class="sidebar-nav">
      <ul>
        <li class="nav-item">
          <a href="index.html">
            <span class="icon"><i class="lni lni-grid-alt"></i></span>
            <span class="text">Dashboard</span>
          </a>
        </li>

        <li class="nav-item active">
          <a href="transaksi.html">
            <span class="icon"><i class="lni lni-list"></i></span>
            <span class="text">Transaksi</span>
          </a>
        </li>

        <li class="nav-item nav-item-has-children">
          <a href="#0" class="collapsed" data-bs-toggle="collapse" data-bs-target="#ddmenu_auth"
            aria-controls="ddmenu_auth" aria-expanded="false" aria-label="Toggle navigation">
            <span class="icon">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M14.9211 10.1294C15.1652 9.88534 15.1652 9.48967 14.9211 9.24559L10.7544 5.0789C10.5103 4.83482 10.1147 4.83482 9.87057 5.0789C9.62649 5.32297 9.62649 5.71871 9.87057 5.96278L12.9702 9.06251H1.97916C1.63398 9.06251 1.35416 9.34234 1.35416 9.68751C1.35416 10.0327 1.63398 10.3125 1.97916 10.3125H12.9702L9.87057 13.4123C9.62649 13.6563 9.62649 14.052 9.87057 14.2961C10.1147 14.5402 10.5103 14.5402 10.7544 14.2961L14.9211 10.1294Z" />
                <path
                  d="M11.6383 15.18L15.805 11.0133C16.5373 10.2811 16.5373 9.09391 15.805 8.36166L11.6383 4.195C11.2722 3.82888 10.7923 3.64582 10.3125 3.64582V3.02082C10.3125 2.10035 11.0587 1.35416 11.9792 1.35416H16.9792C17.8997 1.35416 18.6458 2.10035 18.6458 3.02082V16.3542C18.6458 17.2747 17.8997 18.0208 16.9792 18.0208H11.9792C11.0587 18.0208 10.3125 17.2747 10.3125 16.3542V15.7292C10.7923 15.7292 11.2722 15.5461 11.6383 15.18Z" />
              </svg>
            </span>
            <span class="text">Auth</span>
          </a>
          <ul id="ddmenu_auth" class="collapse dropdown-nav">
            <li>
              <a href="signin.html"> Sign In </a>
            </li>
            <li>
              <a href="signup.html"> Sign Up </a>
            </li>
          </ul>
        </li>

        <span class="divider">
          <hr />
        </span>

        <li class="nav-item">
          <a href="settings.html">
            <span class="icon"><i class="lni lni-cog"></i></span>
            <span class="text">Pengaturan</span>
          </a>
        </li>
      </ul>
    </nav>
  </aside>
  <div class="overlay"></div>
  <main class="main-wrapper">
    <!-- ========== header start ========== -->
    <header class="header">
      <div class="container-fluid">
        <div class="row">
          <div class="col-lg-5 col-md-5 col-6">
            <div class="header-left d-flex align-items-center">
              <div class="menu-toggle-btn mr-15">
                <button id="menu-toggle" class="main-btn primary-btn btn-hover">
                  <i class="lni lni-chevron-left me-2"></i> Menu
                </button>
              </div>
            </div>
          </div>
          <div class="col-lg-7 col-md-7 col-6">
            <div class="header-right">
              <!-- notification start -->
              <div class="notification-box ml-15 d-none d-md-flex">
                <button class="dropdown-toggle" type="button" id="notification" data-bs-toggle="dropdown"
                  aria-expanded="false">
                  <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                      d="M11 20.1667C9.88317 20.1667 8.88718 19.63 8.23901 18.7917H13.761C13.113 19.63 12.1169 20.1667 11 20.1667Z"
                      fill="" />
                    <path
                      d="M10.1157 2.74999C10.1157 2.24374 10.5117 1.83333 11 1.83333C11.4883 1.83333 11.8842 2.24374 11.8842 2.74999V2.82604C14.3932 3.26245 16.3051 5.52474 16.3051 8.24999V14.287C16.3051 14.5301 16.3982 14.7633 16.564 14.9352L18.2029 16.6342C18.4814 16.9229 18.2842 17.4167 17.8903 17.4167H4.10961C3.71574 17.4167 3.5185 16.9229 3.797 16.6342L5.43589 14.9352C5.6017 14.7633 5.69485 14.5301 5.69485 14.287V8.24999C5.69485 5.52474 7.60672 3.26245 10.1157 2.82604V2.74999Z"
                      fill="" />
                  </svg>
                  <span></span>
                </button>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="notification">
                  <li>
                    <a href="#0">
                      <div class="image">
                        <img src="assets/images/lead/lead-6.png" alt="" />
                      </div>
                      <div class="content">
                        <h6>
                          John Doe
                          <span class="text-regular">
                            comment on a product.
                          </span>
                        </h6>
                        <p>
                          Lorem ipsum dolor sit amet, consect etur adipiscing
                          elit Vivamus tortor.
                        </p>
                        <span>10 mins ago</span>
                      </div>
                    </a>
                  </li>
                  <li>
                    <a href="#0">
                      <div class="image">
                        <img src="assets/images/lead/lead-1.png" alt="" />
                      </div>
                      <div class="content">
                        <h6>
                          Jonathon
                          <span class="text-regular">
                            like on a product.
                          </span>
                        </h6>
                        <p>
                          Lorem ipsum dolor sit amet, consect etur adipiscing
                          elit Vivamus tortor.
                        </p>
                        <span>10 mins ago</span>
                      </div>
                    </a>
                  </li>
                </ul>
              </div>
              <!-- notification end -->
              <!-- profile start -->
              <div class="profile-box ml-15">
                <button class="dropdown-toggle bg-transparent border-0" type="button" id="profile"
                  data-bs-toggle="dropdown" aria-expanded="false">
                  <div class="profile-info">
                    <div class="info">
                      <div class="image">
                        <img src="assets/images/profile/profile-image.png" alt="" />
                      </div>
                      <div>
                        <h6 class="fw-500">Adam Joe</h6>
                        <p>Admin</p>
                      </div>
                    </div>
                  </div>
                </button>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profile">
                  <li>
                    <div class="author-info flex items-center !p-1">
                      <div class="image">
                        <img src="assets/images/profile/profile-image.png" alt="image">
                      </div>
                      <div class="content">
                        <h4 class="text-sm">Adam Joe</h4>
                        <a class="text-black/40 dark:text-white/40 hover:text-black dark:hover:text-white text-xs"
                          href="#">Email@gmail.com</a>
                      </div>
                    </div>
                  </li>
                  <li class="divider"></li>
                  <li>
                    <a href="#0">
                      <i class="lni lni-user"></i> View Profile
                    </a>
                  </li>
                  <li>
                    <a href="#0">
                      <i class="lni lni-alarm"></i> Notifications
                    </a>
                  </li>
                  <li>
                    <a href="#0"> <i class="lni lni-inbox"></i> Messages </a>
                  </li>
                  <li>
                    <a href="#0"> <i class="lni lni-cog"></i> Settings </a>
                  </li>
                  <li class="divider"></li>
                  <li>
                    <a href="#0"> <i class="lni lni-exit"></i> Sign Out </a>
                  </li>
                </ul>
              </div>
              <!-- profile end -->
            </div>
          </div>
        </div>
      </div>
    </header>
    <!-- ========== header end ========== -->
    <section class="section">
      <div class="container-fluid">
        <div class="title-wrapper pt-30">
          <div class="row align-items-center">
            <div class="col-md-6">
              <div class="title">
                <h2>Daftar Transaksi</h2>
              </div>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-lg-12">
            <div class="card-style mb-30">
              <div class="title d-flex flex-wrap align-items-center justify-content-between">
                <div class="left">
                  <h6 class="text-medium mb-30">Semua Riwayat</h6>
                </div>
                <div class="right">
                  <button type="button" class="main-btn primary-btn btn-hover btn-sm" data-bs-toggle="modal"
                    data-bs-target="#modalTambahTransaksi">
                    <i class="lni lni-plus mr-5"></i> Tambah Transaksi
                  </button>
                </div>
              </div>

              <div class="table-responsive">
                <table class="table top-selling-table">
                  <thead>
                    <tr>
                      <th>
                        <h6 class="text-sm text-medium">Tanggal</h6>
                      </th>
                      <th class="min-width">
                        <h6 class="text-sm text-medium">Kategori</h6>
                      </th>
                      <th class="min-width">
                        <h6 class="text-sm text-medium">Deskripsi</h6>
                      </th>
                      <th class="min-width">
                        <h6 class="text-sm text-medium">Nominal</h6>
                      </th>
                      <th class="min-width">
                        <h6 class="text-sm text-medium">Tipe</h6>
                      </th>
                      <th class="text-end">
                        <h6 class="text-sm text-medium">Aksi</h6>
                      </th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>
                        <p class="text-sm">21/12/2025</p>
                      </td>
                      <td>
                        <p class="text-sm">Makan & Minum</p>
                      </td>
                      <td>
                        <p class="text-sm text-gray">Nasi Goreng Spesial</p>
                      </td>
                      <td>
                        <p class="text-sm text-danger">Rp 25.000</p>
                      </td>
                      <td><span class="status-btn close-btn">Keluar</span></td>
                      <td>
                        <div class="action justify-content-end">
                          <button class="edit" data-bs-toggle="modal" data-bs-target="#modalEditTransaksi"
                            onclick="editTransaction('21/12/2025', 'Makan & Minum', 'Nasi Goreng Spesial', '25000', 'expense')"
                            title="Edit"><i class="lni lni-pencil"></i></button>
                          <button class="text-danger ml-10" onclick="deleteTransaction(this)" title="Hapus"><i
                              class="lni lni-trash-can"></i></button>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <td>
                        <p class="text-sm">20/12/2025</p>
                      </td>
                      <td>
                        <p class="text-sm">Gaji</p>
                      </td>
                      <td>
                        <p class="text-sm text-gray">Proyek Desain Freelance</p>
                      </td>
                      <td>
                        <p class="text-sm text-success">Rp 1.500.000</p>
                      </td>
                      <td><span class="status-btn success-btn">Masuk</span></td>
                      <td>
                        <div class="action justify-content-end">
                          <button class="edit" data-bs-toggle="modal" data-bs-target="#modalEditTransaksi"
                            onclick="editTransaction('20/12/2025', 'Gaji', 'Proyek Desain Freelance', '1500000', 'income')"><i
                              class="lni lni-pencil"></i></button>
                          <button class="text-danger ml-10" onclick="deleteTransaction(this)"><i
                              class="lni lni-trash-can"></i></button>
                        </div>
                      </td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Modal Tambah Transaksi -->
    <div class="modal fade" id="modalTambahTransaksi" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content card-style">
          <div class="modal-header border-bottom pb-20">
            <h5 class="text-bold mb-0">Tambah Transaksi Baru</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body py-4">

            <div class="mb-4">
              <div class="d-flex gap-2 p-1 bg-light rounded">
                <button type="button" class="btn btn-tab active flex-fill" data-type="expense"
                  onclick="switchTab(this, 'add')">
                  <i class="lni lni-arrow-down-circle me-1"></i> Pengeluaran
                </button>
                <button type="button" class="btn btn-tab flex-fill" data-type="income" onclick="switchTab(this, 'add')">
                  <i class="lni lni-arrow-up-circle me-1"></i> Pemasukan
                </button>
              </div>
              <input type="hidden" id="tipeTransaksiInput" value="expense">
            </div>

            <div class="input-style-1 mb-3">
              <label class="form-label">Tanggal</label>
              <input type="date" id="inputDate" class="form-control" required>
            </div>

            <div class="select-style-1 mb-3">
              <label class="form-label">Kategori</label>
              <div class="select-position">
                <select id="kategoriSelect" class="form-select" onchange="checkCustomCategory(this)" required>
                  <option value="" disabled selected>Pilih Kategori</option>
                  <option value="makan">üçΩÔ∏è Makan & Minum</option>
                  <option value="transport">üöó Transportasi</option>
                  <option value="belanja">üõí Belanja Bulanan</option>
                  <option value="tagihan">‚ö° Tagihan & Listrik</option>
                  <option value="gaji">üí∞ Gaji</option>
                  <option value="custom">‚ûï Buat Kategori Baru...</option>
                </select>
              </div>
            </div>

            <div class="input-style-1 mb-3" id="customCategoryInput" style="display: none;">
              <label class="form-label">Nama Kategori Baru</label>
              <input type="text" class="form-control" placeholder="Contoh: Servis Motor">
            </div>

            <div class="input-style-1 mb-3">
              <label class="form-label">Nominal (Rp)</label>
              <input type="text" id="inputNominal" class="form-control" placeholder="0" required>
              <input type="hidden" id="inputNominalValue">
            </div>

            <div class="input-style-1 mb-0">
              <label class="form-label">Deskripsi / Catatan</label>
              <textarea class="form-control" placeholder="Contoh: Makan siang di restoran..." rows="3"></textarea>
            </div>

          </div>
          <div class="modal-footer border-top pt-20">
            <button type="button" class="main-btn danger-btn-outline btn-hover" data-bs-dismiss="modal">
              <i class="lni lni-close me-1"></i> Batal
            </button>
            <button type="button" class="main-btn primary-btn btn-hover" onclick="saveTransaction()">
              <i class="lni lni-save me-1"></i> Simpan
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal Edit Transaksi -->
    <div class="modal fade" id="modalEditTransaksi" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content card-style">
          <div class="modal-header border-bottom pb-20">
            <h5 class="text-bold mb-0">Edit Transaksi</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body py-4">

            <div class="mb-4">
              <div class="d-flex gap-2 p-1 bg-light rounded">
                <button type="button" class="btn btn-tab flex-fill" data-type="expense"
                  onclick="switchTab(this, 'edit')">
                  <i class="lni lni-arrow-down-circle me-1"></i> Pengeluaran
                </button>
                <button type="button" class="btn btn-tab flex-fill" data-type="income"
                  onclick="switchTab(this, 'edit')">
                  <i class="lni lni-arrow-up-circle me-1"></i> Pemasukan
                </button>
              </div>
              <input type="hidden" id="tipeTransaksiInputEdit" value="">
            </div>

            <div class="input-style-1 mb-3">
              <label class="form-label">Tanggal</label>
              <input type="date" id="inputDateEdit" class="form-control" required>
            </div>

            <div class="select-style-1 mb-3">
              <label class="form-label">Kategori</label>
              <div class="select-position">
                <select id="kategoriSelectEdit" class="form-select" onchange="checkCustomCategoryEdit(this)" required>
                  <option value="" disabled>Pilih Kategori</option>
                  <option value="makan">üçΩÔ∏è Makan & Minum</option>
                  <option value="transport">üöó Transportasi</option>
                  <option value="belanja">üõí Belanja Bulanan</option>
                  <option value="tagihan">‚ö° Tagihan & Listrik</option>
                  <option value="gaji">üí∞ Gaji</option>
                  <option value="custom">‚ûï Buat Kategori Baru...</option>
                </select>
              </div>
            </div>

            <div class="input-style-1 mb-3" id="customCategoryInputEdit" style="display: none;">
              <label class="form-label">Nama Kategori Baru</label>
              <input type="text" class="form-control" placeholder="Contoh: Servis Motor">
            </div>

            <div class="input-style-1 mb-3">
              <label class="form-label">Nominal (Rp)</label>
              <input type="text" id="inputNominalEdit" class="form-control" placeholder="0" required>
              <input type="hidden" id="inputNominalEditValue">

            </div>

            <div class="input-style-1 mb-0">
              <label class="form-label">Deskripsi / Catatan</label>
              <textarea id="inputDeskripsiEdit" class="form-control" placeholder="Contoh: Makan siang di restoran..."
                rows="3"></textarea>
            </div>

          </div>
          <div class="modal-footer border-top pt-20">
            <button type="button" class="main-btn danger-btn-outline btn-hover" data-bs-dismiss="modal">
              <i class="lni lni-close me-1"></i> Batal
            </button>
            <button type="button" class="main-btn primary-btn btn-hover" onclick="updateTransaction()">
              <i class="lni lni-checkmark-circle me-1"></i> Update
            </button>
          </div>
        </div>
      </div>
    </div>

    <footer class="footer">
      <div class="container-fluid">
        <div class="row">
          <div class="col-md-6 order-last order-md-first">
            <div class="copyright text-center text-md-start">
              <p class="text-sm">Designed by PlainAdmin</p>
            </div>
          </div>
        </div>
      </div>
    </footer>
  </main>
  <script src="assets/js/bootstrap.bundle.min.js"></script>
  <script src="assets/js/main.js"></script>

  <script>
    // Set Tanggal Default saat halaman dimuat
    document.addEventListener('DOMContentLoaded', function () {
      document.getElementById('inputDate').valueAsDate = new Date();
    });

    // Fungsi untuk format nominal dengan pemisah ribuan (thousand separator)
    function formatRupiah(value) {
      return value
        .replace(/\D/g, "")
        .replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    }

    function bindRupiahInput(inputId, hiddenId) {
      const input = document.getElementById(inputId);
      const hidden = document.getElementById(hiddenId);

      input.addEventListener("input", () => {
        const raw = input.value.replace(/\D/g, "");
        hidden.value = raw;
        input.value = raw ? formatRupiah(raw) : "";
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      bindRupiahInput("inputNominal", "inputNominalValue");
      bindRupiahInput("inputNominalEdit", "inputNominalEditValue");
    });

    // Fungsi untuk switch tab (Pengeluaran/Pemasukan)
    function switchTab(button, modalType) {
      // Remove active class from all tabs in the same modal
      const parentDiv = button.parentElement;
      const allTabs = parentDiv.querySelectorAll('.btn-tab');
      allTabs.forEach(tab => tab.classList.remove('active'));

      // Add active class to clicked tab
      button.classList.add('active');

      // Update hidden input value
      const type = button.getAttribute('data-type');
      if (modalType === 'add') {
        document.getElementById('tipeTransaksiInput').value = type;
      } else {
        document.getElementById('tipeTransaksiInputEdit').value = type;
      }
    }

    // Logic Kategori Custom untuk Modal Tambah
    function checkCustomCategory(selectObject) {
      var value = selectObject.value;
      var customInputDiv = document.getElementById("customCategoryInput");

      if (value === "custom") {
        customInputDiv.style.display = "block";
        customInputDiv.querySelector('input').focus();
      } else {
        customInputDiv.style.display = "none";
      }
    }

    // Logic Kategori Custom untuk Modal Edit
    function checkCustomCategoryEdit(selectObject) {
      var value = selectObject.value;
      var customInputDiv = document.getElementById("customCategoryInputEdit");

      if (value === "custom") {
        customInputDiv.style.display = "block";
        customInputDiv.querySelector('input').focus();
      } else {
        customInputDiv.style.display = "none";
      }
    }

    // Fungsi untuk menyimpan transaksi baru
    function saveTransaction() {
      // Ambil nilai nominal tanpa format
      const nominalFormatted = document.getElementById('inputNominal').value;
      const nominalValue = document.getElementById('inputNominalValue').value;


      console.log('Nominal yang disimpan:', nominalValue);

      // Implementasi logika simpan di sini
      alert('Transaksi berhasil disimpan!\nNominal: Rp ' + nominalFormatted);

      // Tutup modal
      var modal = bootstrap.Modal.getInstance(document.getElementById('modalTambahTransaksi'));
      modal.hide();

      // Reset form
      document.getElementById('inputDate').valueAsDate = new Date();
      document.getElementById('kategoriSelect').selectedIndex = 0;
      document.getElementById('inputNominal').value = '';
    }

    // Fungsi untuk mengisi data ke modal edit
    function editTransaction(tanggal, kategori, deskripsi, nominal, tipe) {
      // Konversi tanggal dari DD/MM/YYYY ke YYYY-MM-DD
      var parts = tanggal.split('/');
      var dateFormatted = parts[2] + '-' + parts[1] + '-' + parts[0];

      document.getElementById('inputDateEdit').value = dateFormatted;

      // Format nominal dengan pemisah ribuan
      document.getElementById('inputNominalEdit').value = formatRupiah(nominal);
      document.getElementById('inputNominalEditValue').value = nominal;


      document.getElementById('inputDeskripsiEdit').value = deskripsi;

      // Set tipe transaksi dengan tab
      const editModal = document.getElementById('modalEditTransaksi');
      const tabs = editModal.querySelectorAll('.btn-tab');
      tabs.forEach(tab => {
        if (tab.getAttribute('data-type') === tipe) {
          tab.classList.add('active');
        } else {
          tab.classList.remove('active');
        }
      });
      document.getElementById('tipeTransaksiInputEdit').value = tipe;

      // Set kategori
      var kategoriMap = {
        'Makan & Minum': 'makan',
        'Transportasi': 'transport',
        'Belanja Bulanan': 'belanja',
        'Tagihan & Listrik': 'tagihan',
        'Gaji': 'gaji'
      };

      var kategoriValue = kategoriMap[kategori] || 'makan';
      document.getElementById('kategoriSelectEdit').value = kategoriValue;
    }

    // Fungsi untuk update transaksi
    function updateTransaction() {
      const nominalValue =
        document.getElementById('inputNominalEditValue').value;

      console.log("Nominal diupdate:", nominalValue);

      alert("Transaksi berhasil diupdate\nRp " +
        document.getElementById('inputNominalEdit').value
      );

      bootstrap.Modal.getInstance(
        document.getElementById('modalEditTransaksi')
      ).hide();
    }


    // Fungsi untuk hapus transaksi
    function deleteTransaction(button) {
      if (confirm('Apakah Anda yakin ingin menghapus transaksi ini?')) {
        var row = button.closest('tr');
        row.remove();

        alert('Transaksi berhasil dihapus!');
      }
    }
  </script>
</body>

</html>